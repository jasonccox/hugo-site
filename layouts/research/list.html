{{ define "main" }}
  <h1>{{ .Title }}</h1>

  <div id="research-info">
    <img
      alt=""
      id="research-info-img"
      src="/images/headshot-square.png"
    >
    <div id="research-info-txt">
      <p>
        <strong>Jason Cox</strong><br>
        Ph.D. Student<br>
        School of Computer Science<br>
        Georgia Institute of Technology
      </p>
      <p><a href="mailto:jcox99@gatech.edu">jcox99@gatech.edu</a></p>
    </div>
  </div>

  {{ .Content }}

  {{ $current_projects := where .Pages "Params.project_end_date" "==" nil }}
  {{ $past_projects := where .Pages "Params.project_end_date" "!=" nil }}
  {{
     with (
        sort $current_projects "Params.project_start_date" "desc"
        | append (
          sort $past_projects "Params.project_end_date" "desc"
        )
     )
  }}
    <h2>Projects</h2>
    <ul class="research-project-list">
      {{ range . }}
        {{ $start_date := dateFormat "Jan 2006" .Params.project_start_date }}
        {{ $end_date := "Present" }}
        {{ if .Params.project_end_date }}
          {{ $end_date = dateFormat "Jan 2006" .Params.project_end_date }}
        {{ end }}

        <li class="research-project">
          <p class="research-project-desc">
            {{ if not (eq .Content .Summary) }}
              <a href="{{ .RelPermalink }}">{{ .Title }}</a>
            {{ else }}
              <strong>{{ .Title }}</strong>
            {{ end }}
            ({{ $start_date }} - {{ $end_date }}):
            <span>{{ .Summary | replaceRE "</?p>" "" | safeHTML }}</span>
          </p>
          {{ if .Params.image }}
          <img
            class="research-project-img"
            src="{{.Params.image}}"
            alt="{{.Params.image_alt}}"
          />
          {{ end }}
        </li>
      {{ end }}
    </ul>
  {{ end }}
{{ end }}

{{ define "page-styles" }}
  <style>
    #research-info {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
    }

    #research-info > * {
      margin: 0.5rem;
    }

    #research-info-img {
      border-radius: 0.25rem;
      height: 10rem;
      width: 10rem;
    }

    .research-project-list {
      list-style: none;
      padding: 0;
    }

    .research-project {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
    }

    .research-project-desc {
      max-width: 100%;
      flex-basis: 65%;
      flex-grow: 1;
      flex-shrink: 0;
      order: 1;
    }

    .research-project-img {
      min-width: 10rem;
      max-width: 15rem;
      flex-basis: 10rem;
      flex-grow: 1;
      order: 0;
      margin: 1rem;
    }
  </style>
{{ end }}
